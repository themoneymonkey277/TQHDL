<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Biểu đồ Thống kê Số Lượng Tác Phẩm theo Loại Nghệ Thuật</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        #chart-container {
            margin: auto;
            text-align: center;
            background-color: #f0f0f0; /* Tô màu nền cho khung chứa biểu đồ */
            padding: 20px; /* Thêm padding để tạo khoảng cách với biểu đồ */
        }

        .bar {
            fill: steelblue;
        }

        .bar:hover {
            fill: #4682b4;
        }

        .axis text {
            font: 10px sans-serif;
        }

        .comment-container {
            margin-top: 10px;
            margin-bottom: 10px; /* Thêm margin-bottom để tạo khoảng cách với biểu đồ */
            text-align: left;
        }

        .comment-text {
            font-size: 20px;
            color: black;
            margin: 0;
            margin-left: 150px;
        }

        .bold-text {
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div style="margin-left: 50px;">
        <h3">Câu hỏi 7: </h3>
            <div style="margin-left: 30px;">
                <h3><b>Yêu cầu:</b> Thống kê số lượng tác phẩm theo loại hình nghệ thuật
                </h3>
                <h3>Thiết kế biểu đồ:</h3>
            </div>
            <div style="margin-left: 50px;">
                <p">Ở trong yêu cầu này, sử dụng thuộc tính Type để tính số lượng tác phẩm theo loại thuộc tính
                    </p>
                    <p">Ta sẽ sử dụng các kênh sau</p>
                        <p">- Vị trí theo chiều dọc: Thuộc tính số lượng tác phẩm nghệ thuật</p>
                            <p">- Vị trí theo chiều ngang: Thuộc tính loại nghệ thuật</p>
            </div>
    </div>
    <h1 style="text-align: center;">Biểu đồ Thống kê Số Lượng Tác Phẩm theo Loại Hình Nghệ Thuật</h1>    <div id="chart"></div>
    <div style="margin-left: 80px;">
        <h3>Đánh giá biểu đồ:</h3>
        <div style="margin-left: 20px;">
            <p>Biểu đồ giúp phân tích và so sánh số lượng tác phẩm của mỗi loại hình nghệ thuật
            </p>
            <p>Thông qua biểu đồ, có thể nhận biết được loại hình nghệ thuật nào có số lượng tác phẩm nhiều nhất và ít nhất</p>
        </div>
    </div>
    <script>
        d3.csv("Art_in_Public_Places.csv").then(function(data) {
            // Tạo đối tượng để lưu trữ số lượng tác phẩm của mỗi loại nghệ thuật
            var typeCounts = {};

            // Lặp qua dữ liệu và tính số lượng tác phẩm của mỗi loại nghệ thuật
            data.forEach(function(d) {
                var type = d.Type;
                if (!typeCounts[type]) {
                    typeCounts[type] = 0;
                }
                typeCounts[type]++;
            });

            // Chuyển đổi dữ liệu thành mảng các đối tượng {type, count}
            var chartData = Object.keys(typeCounts).map(function(type) {
                return { type: type, count: typeCounts[type] };
            });

            chartData.sort(function(a,b)
            {
                return b.count-a.count;
            });
            // Tạo biểu đồ
            var svgWidth = 1000; // Đã thay đổi kích thước
            var svgHeight = 500;
            var margin = { top: 20, right: 20, bottom: 50, left: 70 };
            var width = svgWidth - margin.left - margin.right;
            var height = svgHeight - margin.top - margin.bottom;

            var svg = d3.select("#chart")
                .append("svg")
                .attr("width", svgWidth)
                .attr("height", svgHeight);

            var x = d3.scaleBand()
                .range([0, width])
                .padding(0.1)
                .domain(chartData.map(function(d) { return d.type; }));

            var y = d3.scaleLinear()
                .range([height, 0])
                .domain([0, d3.max(chartData, function(d) { return d.count; })]);

            var g = svg.append("g")
                .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

            g.selectAll(".bar")
                .data(chartData)
                .enter().append("rect")
                .attr("class", "bar")
                .attr("x", function(d) { return x(d.type); })
                .attr("y", function(d) { return y(d.count); })
                .attr("width", x.bandwidth())
                .attr("height", function(d) { return height - y(d.count); })
                .append("title") // Chú thích cho cột
                .text(function(d) { return d.count; });

            g.append("g")
                .attr("class", "x-axis")
                .attr("transform", "translate(0," + height + ")")
                .call(d3.axisBottom(x));

            g.append("g")
                .attr("class", "y-axis")
                .call(d3.axisLeft(y));

            // Thêm nhãn cho trục x
            svg.append("text")
                .attr("transform", "translate(" + (width / 2) + " ," + (height + margin.top + 40) + ")")
                .style("text-anchor", "middle")
                .style("font-weight", "bold")
                .text("Loại Nghệ Thuật");

            // Thêm nhãn cho trục y
            svg.append("text")
                .attr("transform", "rotate(-90)")
                .attr("y", 0 - margin.left)
                .attr("x", 0 - (height / 2))
                .attr("dy", "5em")
                .style("font-weight", "bold")
                .style("text-anchor", "middle")
                .text("Số Lượng Tác Phẩm");
        });
    </script>
</body>
</html>
